(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function c(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function s(t){if(t.ep)return;t.ep=!0;const e=c(t);fetch(t.href,e)}})();function u(n){localStorage.setItem("contacts",JSON.stringify(n))}function d(){return JSON.parse(localStorage.getItem("contacts"))||{}}function p(n,o,c,s){const t=o.charAt(0).toLowerCase(),e=d();e[t]||(e[t]=[]);const r=e[t].findIndex(a=>a.id===n);r!==-1?e[t][r]={id:n,name:o,vacancy:c,phone:s}:e[t].push({id:n,name:o,vacancy:c,phone:s}),u(e)}function y(n){const o=d();for(const[c,s]of Object.entries(o)){const t=s.find(e=>e.id===n);if(t)return t}return null}function v(n){n.forEach((o,c)=>{o.style.zIndex=n.length-c})}function L(n){n.addEventListener("input",o=>{const c=o.target,s=c.selectionStart;let t=c.value.replace(/\D/g,"");t.startsWith("7")||(t="7"+t);let e="+7";t.length>1&&(e+=` (${t.substring(1,4)}`),t.length>=5&&(e+=`) ${t.substring(4,7)}`),t.length>=8&&(e+=`-${t.substring(7,9)}`),t.length>=10&&(e+=`-${t.substring(9,11)}`);const r=c.value.length;c.value=e;const i=c.value.length-r;c.selectionStart=c.selectionEnd=s+i}),n.addEventListener("blur",o=>{o.target.value==="+7"&&(o.target.value="")})}function _(n,o,c,s){const t={status:!0,message:""};return(!o||!c||!s)&&(t.status=!1,t.message="All fields are required!"),n||(t.status=!1,t.message="No card for this letter!"),/^\+7 \(\d{3}\) \d{3}-\d{2}-\d{2}$/.test(s)||(t.status=!1,t.message="Invalid phone format! Use +7 (XXX) XXX-XX-XX"),t}const E=document.getElementById("js-btn-add");document.getElementById("js-btn-clear");const N=document.getElementById("js-input-name"),S=document.getElementById("js-input-vacancy"),f=document.getElementById("js-input-phone"),l=document.querySelectorAll(".contacts__card");C();L(f);v(l);E.addEventListener("click",()=>{const n=N.value.trim(),o=n.charAt(0).toLowerCase(),c=S.value.trim(),s=f.value.trim(),t=Array.from(l).find(r=>r.id===o),e=_(t,n,c,s);if(!e.status){alert(e.message);return}I(t,n,c,s)});l.forEach(n=>{n.querySelector(".card__container").addEventListener("click",()=>{n.classList.toggle("show")})});function I(n,o,c,s){n.classList.add("filled");const t=n.querySelector(".card__num"),e=parseInt(t.innerText,10)||0;t.innerText=e+1;const r=n.querySelector(".card__info")||m(n),a=g(r,o,c,s);p(a,o,c,s)}function m(n){const o=document.createElement("div");return o.classList.add("card__info"),n.append(o),o}function g(n,o,c,s,t){t||(t=`contact_${Date.now()}_${Math.random().toString(36).slice(2,11)}`);const e=document.createElement("div");return e.classList.add("contact"),e.dataset.id=t,e.innerHTML=`
        <p class="contact__text">
            Name: ${o}<br/>
            Vacancy: ${c}<br/>
            Phone: ${s}
        </p>
        <i class="fa-solid fa-pen js-contact-edit"></i>
        <i class="fa-solid fa-xmark js-contact-delete"></i>
    `,e.querySelector(".js-contact-delete").addEventListener("click",()=>b(n,e)),e.querySelector(".js-contact-edit").addEventListener("click",()=>x(t)),n.append(e),t}function x(n,o){y(n)}function C(){const n=d();for(const[o,c]of Object.entries(n)){const s=document.getElementById(o);if(s){s.classList.add("filled");const t=s.querySelector(".card__info")||m(s);c.forEach(({id:r,name:a,vacancy:i,phone:h})=>{g(t,a,i,h,r)});const e=s.querySelector(".card__num");c.length?e.innerText=c.length:e.innerText=""}}}function b(n,o){o.remove();const c=o.dataset.id,s=n.closest(".contacts__card"),t=s.querySelector(".card__num"),e=parseInt(t.innerText,10)||0,r=s.id,a=d();a[r]&&(a[r]=a[r].filter(i=>i.id!==c),a[r].length===0&&delete a[r],u(a)),e<=1?(t.innerText="",s.classList.remove("filled","show")):t.innerText=e-1}
